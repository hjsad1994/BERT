<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.2 (20251019.1705)
 -->
<!-- Title: DualTaskArchitecture Pages: 1 -->
<svg width="1305pt" height="698pt"
 viewBox="0.00 0.00 1305.00 698.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 693.55)">
<title>DualTaskArchitecture</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-693.55 1300.75,-693.55 1300.75,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_legend</title>
<polygon fill="white" stroke="#cfd8dc" stroke-dasharray="5,2" points="258.75,-607.3 258.75,-681.55 1288.75,-681.55 1288.75,-607.3 258.75,-607.3"/>
<text xml:space="preserve" text-anchor="middle" x="773.75" y="-666.15" font-family="Inter,Helvetica,Arial" font-size="12.00">Notes</text>
</g>
<!-- input_text -->
<g id="node1" class="node">
<title>input_text</title>
<path fill="#e8f5e9" stroke="#2f4f4f" d="M225.12,-662.1C225.12,-662.1 124.38,-662.1 124.38,-662.1 118.38,-662.1 112.38,-656.1 112.38,-650.1 112.38,-650.1 112.38,-616.5 112.38,-616.5 112.38,-610.5 118.38,-604.5 124.38,-604.5 124.38,-604.5 225.12,-604.5 225.12,-604.5 231.12,-604.5 237.12,-610.5 237.12,-616.5 237.12,-616.5 237.12,-650.1 237.12,-650.1 237.12,-656.1 231.12,-662.1 225.12,-662.1"/>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-636.15" font-family="Inter,Helvetica,Arial" font-size="12.00">Input Text</text>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-621.9" font-family="Inter,Helvetica,Arial" font-size="12.00">(Vietnamese review)</text>
</g>
<!-- tokenizer -->
<g id="node2" class="node">
<title>tokenizer</title>
<path fill="#e3f2fd" stroke="#1e88e5" d="M252.12,-538C252.12,-538 97.38,-538 97.38,-538 91.38,-538 85.38,-532 85.38,-526 85.38,-526 85.38,-513.5 85.38,-513.5 85.38,-507.5 91.38,-501.5 97.38,-501.5 97.38,-501.5 252.12,-501.5 252.12,-501.5 258.12,-501.5 264.12,-507.5 264.12,-513.5 264.12,-513.5 264.12,-526 264.12,-526 264.12,-532 258.12,-538 252.12,-538"/>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-522.6" font-family="Inter,Helvetica,Arial" font-size="12.00">Tokenizer</text>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-508.35" font-family="Inter,Helvetica,Arial" font-size="12.00">(5CD&#45;AI/visobert&#45;14gb&#45;corpus)</text>
</g>
<!-- input_text&#45;&gt;tokenizer -->
<g id="edge1" class="edge">
<title>input_text&#45;&gt;tokenizer</title>
<path fill="none" stroke="#546e7a" d="M174.75,-604.15C174.75,-587.53 174.75,-566.53 174.75,-549.76"/>
<polygon fill="#546e7a" stroke="#546e7a" points="178.25,-549.94 174.75,-539.94 171.25,-549.94 178.25,-549.94"/>
<text xml:space="preserve" text-anchor="middle" x="210" y="-573" font-family="Times New Roman,serif" font-size="10.00">tokenize</text>
<text xml:space="preserve" text-anchor="middle" x="210" y="-561.75" font-family="Times New Roman,serif" font-size="10.00">max_length=256</text>
</g>
<!-- bert -->
<g id="node3" class="node">
<title>bert</title>
<path fill="#e1f5fe" stroke="#1e88e5" d="M248.38,-446.25C248.38,-446.25 101.12,-446.25 101.12,-446.25 95.12,-446.25 89.12,-440.25 89.12,-434.25 89.12,-434.25 89.12,-407.5 89.12,-407.5 89.12,-401.5 95.12,-395.5 101.12,-395.5 101.12,-395.5 248.38,-395.5 248.38,-395.5 254.38,-395.5 260.38,-401.5 260.38,-407.5 260.38,-407.5 260.38,-434.25 260.38,-434.25 260.38,-440.25 254.38,-446.25 248.38,-446.25"/>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-430.85" font-family="Inter,Helvetica,Arial" font-size="12.00">BERT Encoder</text>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-416.6" font-family="Inter,Helvetica,Arial" font-size="12.00">5CD&#45;AI/visobert&#45;14gb&#45;corpus</text>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-402.35" font-family="Inter,Helvetica,Arial" font-size="12.00">Output: [B, L, H_bert]</text>
</g>
<!-- tokenizer&#45;&gt;bert -->
<g id="edge2" class="edge">
<title>tokenizer&#45;&gt;bert</title>
<path fill="none" stroke="#546e7a" d="M174.75,-501.43C174.75,-489.41 174.75,-472.95 174.75,-458.12"/>
<polygon fill="#546e7a" stroke="#546e7a" points="178.25,-458.2 174.75,-448.2 171.25,-458.2 178.25,-458.2"/>
<text xml:space="preserve" text-anchor="middle" x="228" y="-470" font-family="Times New Roman,serif" font-size="10.00">input_ids, attention_mask</text>
</g>
<!-- cls -->
<g id="node4" class="node">
<title>cls</title>
<path fill="#e3f2fd" stroke="#1e88e5" d="M204.88,-340.25C204.88,-340.25 144.62,-340.25 144.62,-340.25 138.62,-340.25 132.62,-334.25 132.62,-328.25 132.62,-328.25 132.62,-315.75 132.62,-315.75 132.62,-309.75 138.62,-303.75 144.62,-303.75 144.62,-303.75 204.88,-303.75 204.88,-303.75 210.88,-303.75 216.88,-309.75 216.88,-315.75 216.88,-315.75 216.88,-328.25 216.88,-328.25 216.88,-334.25 210.88,-340.25 204.88,-340.25"/>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-324.85" font-family="Inter,Helvetica,Arial" font-size="12.00">CLS Pooling</text>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-310.6" font-family="Inter,Helvetica,Arial" font-size="12.00">[H_bert]</text>
</g>
<!-- bert&#45;&gt;cls -->
<g id="edge3" class="edge">
<title>bert&#45;&gt;cls</title>
<path fill="none" stroke="#546e7a" d="M174.75,-395.18C174.75,-382 174.75,-365.7 174.75,-351.93"/>
<polygon fill="#546e7a" stroke="#546e7a" points="178.25,-352.13 174.75,-342.13 171.25,-352.13 178.25,-352.13"/>
<text xml:space="preserve" text-anchor="middle" x="196.5" y="-364" font-family="Times New Roman,serif" font-size="10.00">take [CLS]</text>
</g>
<!-- dense -->
<g id="node5" class="node">
<title>dense</title>
<path fill="#fff3e0" stroke="#1e88e5" d="M238.25,-248.5C238.25,-248.5 111.25,-248.5 111.25,-248.5 105.25,-248.5 99.25,-242.5 99.25,-236.5 99.25,-236.5 99.25,-209.75 99.25,-209.75 99.25,-203.75 105.25,-197.75 111.25,-197.75 111.25,-197.75 238.25,-197.75 238.25,-197.75 244.25,-197.75 250.25,-203.75 250.25,-209.75 250.25,-209.75 250.25,-236.5 250.25,-236.5 250.25,-242.5 244.25,-248.5 238.25,-248.5"/>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-233.1" font-family="Inter,Helvetica,Arial" font-size="12.00">Dense + ReLU + Dropout</text>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-218.85" font-family="Inter,Helvetica,Arial" font-size="12.00">Hidden: 512</text>
<text xml:space="preserve" text-anchor="middle" x="174.75" y="-204.6" font-family="Inter,Helvetica,Arial" font-size="12.00">[H_shared]</text>
</g>
<!-- cls&#45;&gt;dense -->
<g id="edge4" class="edge">
<title>cls&#45;&gt;dense</title>
<path fill="none" stroke="#546e7a" d="M174.75,-303.68C174.75,-291.66 174.75,-275.2 174.75,-260.37"/>
<polygon fill="#546e7a" stroke="#546e7a" points="178.25,-260.45 174.75,-250.45 171.25,-260.45 178.25,-260.45"/>
<text xml:space="preserve" text-anchor="middle" x="204.75" y="-272.25" font-family="Times New Roman,serif" font-size="10.00">shared features</text>
</g>
<!-- ad_head -->
<g id="node6" class="node">
<title>ad_head</title>
<path fill="#e8f5e9" stroke="#43a047" d="M154.25,-142.5C154.25,-142.5 39.25,-142.5 39.25,-142.5 33.25,-142.5 27.25,-136.5 27.25,-130.5 27.25,-130.5 27.25,-103.75 27.25,-103.75 27.25,-97.75 33.25,-91.75 39.25,-91.75 39.25,-91.75 154.25,-91.75 154.25,-91.75 160.25,-91.75 166.25,-97.75 166.25,-103.75 166.25,-103.75 166.25,-130.5 166.25,-130.5 166.25,-136.5 160.25,-142.5 154.25,-142.5"/>
<text xml:space="preserve" text-anchor="middle" x="96.75" y="-127.1" font-family="Inter,Helvetica,Arial" font-size="12.00">Aspect Detection Head</text>
<text xml:space="preserve" text-anchor="middle" x="96.75" y="-112.85" font-family="Inter,Helvetica,Arial" font-size="12.00">Linear: 512 → 11</text>
<text xml:space="preserve" text-anchor="middle" x="96.75" y="-98.6" font-family="Inter,Helvetica,Arial" font-size="12.00">Logits: [B, 11]</text>
</g>
<!-- dense&#45;&gt;ad_head -->
<g id="edge5" class="edge">
<title>dense&#45;&gt;ad_head</title>
<path fill="none" stroke="#2e7d32" d="M156.27,-197.48C146.04,-183.85 133.19,-166.71 122.05,-151.86"/>
<polygon fill="#2e7d32" stroke="#2e7d32" points="125.08,-150.07 116.28,-144.17 119.48,-154.27 125.08,-150.07"/>
<text xml:space="preserve" text-anchor="middle" x="160.59" y="-166.25" font-family="Times New Roman,serif" font-size="10.00">[H_shared]</text>
</g>
<!-- sc_head -->
<g id="node7" class="node">
<title>sc_head</title>
<path fill="#fff3e0" stroke="#fb8c00" d="M325,-142.5C325,-142.5 232.5,-142.5 232.5,-142.5 226.5,-142.5 220.5,-136.5 220.5,-130.5 220.5,-130.5 220.5,-103.75 220.5,-103.75 220.5,-97.75 226.5,-91.75 232.5,-91.75 232.5,-91.75 325,-91.75 325,-91.75 331,-91.75 337,-97.75 337,-103.75 337,-103.75 337,-130.5 337,-130.5 337,-136.5 331,-142.5 325,-142.5"/>
<text xml:space="preserve" text-anchor="middle" x="278.75" y="-127.1" font-family="Inter,Helvetica,Arial" font-size="12.00">Sentiment Head</text>
<text xml:space="preserve" text-anchor="middle" x="278.75" y="-112.85" font-family="Inter,Helvetica,Arial" font-size="12.00">Linear: 512 → 33</text>
<text xml:space="preserve" text-anchor="middle" x="278.75" y="-98.6" font-family="Inter,Helvetica,Arial" font-size="12.00">Reshape: [B, 11, 3]</text>
</g>
<!-- dense&#45;&gt;sc_head -->
<g id="edge6" class="edge">
<title>dense&#45;&gt;sc_head</title>
<path fill="none" stroke="#ef6c00" d="M199.4,-197.48C213.28,-183.59 230.81,-166.07 245.85,-151.02"/>
<polygon fill="#ef6c00" stroke="#ef6c00" points="248.25,-153.57 252.85,-144.03 243.3,-148.62 248.25,-153.57"/>
<text xml:space="preserve" text-anchor="middle" x="252.37" y="-166.25" font-family="Times New Roman,serif" font-size="10.00">[H_shared]</text>
</g>
<!-- ad_post -->
<g id="node8" class="node">
<title>ad_post</title>
<path fill="#f1f8e9" stroke="#1e88e5" d="M155.5,-36.5C155.5,-36.5 12,-36.5 12,-36.5 6,-36.5 0,-30.5 0,-24.5 0,-24.5 0,-12 0,-12 0,-6 6,0 12,0 12,0 155.5,0 155.5,0 161.5,0 167.5,-6 167.5,-12 167.5,-12 167.5,-24.5 167.5,-24.5 167.5,-30.5 161.5,-36.5 155.5,-36.5"/>
<text xml:space="preserve" text-anchor="middle" x="83.75" y="-21.1" font-family="Inter,Helvetica,Arial" font-size="12.00">Sigmoid → Aspect presence</text>
<text xml:space="preserve" text-anchor="middle" x="83.75" y="-6.85" font-family="Inter,Helvetica,Arial" font-size="12.00">[B, aspects]</text>
</g>
<!-- ad_head&#45;&gt;ad_post -->
<g id="edge7" class="edge">
<title>ad_head&#45;&gt;ad_post</title>
<path fill="none" stroke="#2e7d32" d="M93.44,-91.43C91.67,-78.25 89.48,-61.95 87.63,-48.18"/>
<polygon fill="#2e7d32" stroke="#2e7d32" points="91.11,-47.82 86.32,-38.37 84.18,-48.75 91.11,-47.82"/>
<text xml:space="preserve" text-anchor="middle" x="106.75" y="-60.25" font-family="Times New Roman,serif" font-size="10.00">sigmoid</text>
</g>
<!-- sc_post -->
<g id="node9" class="node">
<title>sc_post</title>
<path fill="#fffde7" stroke="#1e88e5" d="M374.75,-36.5C374.75,-36.5 208.75,-36.5 208.75,-36.5 202.75,-36.5 196.75,-30.5 196.75,-24.5 196.75,-24.5 196.75,-12 196.75,-12 196.75,-6 202.75,0 208.75,0 208.75,0 374.75,0 374.75,0 380.75,0 386.75,-6 386.75,-12 386.75,-12 386.75,-24.5 386.75,-24.5 386.75,-30.5 380.75,-36.5 374.75,-36.5"/>
<text xml:space="preserve" text-anchor="middle" x="291.75" y="-21.1" font-family="Inter,Helvetica,Arial" font-size="12.00">Softmax → Sentiment per aspect</text>
<text xml:space="preserve" text-anchor="middle" x="291.75" y="-6.85" font-family="Inter,Helvetica,Arial" font-size="12.00">[B, aspects, 3]</text>
</g>
<!-- sc_head&#45;&gt;sc_post -->
<g id="edge8" class="edge">
<title>sc_head&#45;&gt;sc_post</title>
<path fill="none" stroke="#ef6c00" d="M282.06,-91.43C283.83,-78.25 286.02,-61.95 287.87,-48.18"/>
<polygon fill="#ef6c00" stroke="#ef6c00" points="291.32,-48.75 289.18,-38.37 284.39,-47.82 291.32,-48.75"/>
<text xml:space="preserve" text-anchor="middle" x="322.79" y="-60.25" font-family="Times New Roman,serif" font-size="10.00">softmax (last dim)</text>
</g>
<!-- note1 -->
<g id="node10" class="node">
<title>note1</title>
<path fill="white" stroke="#1e88e5" d="M623,-651.3C623,-651.3 278.5,-651.3 278.5,-651.3 272.5,-651.3 266.5,-645.3 266.5,-639.3 266.5,-639.3 266.5,-627.3 266.5,-627.3 266.5,-621.3 272.5,-615.3 278.5,-615.3 278.5,-615.3 623,-615.3 623,-615.3 629,-615.3 635,-621.3 635,-627.3 635,-627.3 635,-639.3 635,-639.3 635,-645.3 629,-651.3 623,-651.3"/>
<text xml:space="preserve" text-anchor="middle" x="450.75" y="-629.02" font-family="Inter,Helvetica,Arial" font-size="12.00">B = batch size, L = sequence length, H_bert = hidden size of BERT</text>
</g>
<!-- note2 -->
<g id="node11" class="node">
<title>note2</title>
<path fill="white" stroke="#1e88e5" d="M893.62,-651.3C893.62,-651.3 675.88,-651.3 675.88,-651.3 669.88,-651.3 663.88,-645.3 663.88,-639.3 663.88,-639.3 663.88,-627.3 663.88,-627.3 663.88,-621.3 669.88,-615.3 675.88,-615.3 675.88,-615.3 893.62,-615.3 893.62,-615.3 899.62,-615.3 905.62,-621.3 905.62,-627.3 905.62,-627.3 905.62,-639.3 905.62,-639.3 905.62,-645.3 899.62,-651.3 893.62,-651.3"/>
<text xml:space="preserve" text-anchor="middle" x="784.75" y="-629.02" font-family="Inter,Helvetica,Arial" font-size="12.00">Aspects: 11 &#160;| &#160;Sentiments: 3 (pos/neg/neu)</text>
</g>
<!-- note3 -->
<g id="node12" class="node">
<title>note3</title>
<path fill="white" stroke="#1e88e5" d="M1269.12,-651.3C1269.12,-651.3 946.38,-651.3 946.38,-651.3 940.38,-651.3 934.38,-645.3 934.38,-639.3 934.38,-639.3 934.38,-627.3 934.38,-627.3 934.38,-621.3 940.38,-615.3 946.38,-615.3 946.38,-615.3 1269.12,-615.3 1269.12,-615.3 1275.12,-615.3 1281.12,-621.3 1281.12,-627.3 1281.12,-627.3 1281.12,-639.3 1281.12,-639.3 1281.12,-645.3 1275.12,-651.3 1269.12,-651.3"/>
<text xml:space="preserve" text-anchor="middle" x="1107.75" y="-629.02" font-family="Inter,Helvetica,Arial" font-size="12.00">Outputs: AD uses sigmoid; SC uses softmax over 3 sentiments</text>
</g>
</g>
</svg>
